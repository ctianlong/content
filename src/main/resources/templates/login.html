<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Tool | 登录</title>
    <div th:replace="common/head"></div>
    <style>
        .content {
            background: url(http://ojrkb9vnt.bkt.clouddn.com/image/969d71e6-2126-4313-a5d7-9a28ebc78837.jpg) no-repeat;
            background-size:cover;
        }
        .login-box-body {
            background: initial;
        }
    </style>
</head>

<body class="hold-transition login-page content">
<div class="login-box">
    <div class="login-logo" style="color: #FFF;">
        <b>Tool</b>
    </div>
    <!-- /.login-logo -->
    <div class="login-box-body">
        <!--<p class="login-box-msg">欢迎</p>-->
        <form id="loginForm">
            <div class="form-group has-feedback">
                <input type="text" class="form-control" placeholder="用户名" id="username" required="required"/>
                <span class="fa fa-user form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="password" class="form-control" placeholder="密码" id="password" required="required"/>
                <span class="fa fa-lock form-control-feedback"></span>
            </div>
            <div class="row">
                <!--
                <div class="col-xs-8">
                    <div class="checkbox icheck">
                        <label>
                            <input type="checkbox" name="remember-me"/> 记住密码
                        </label>
                    </div>
                </div>
                 -->
                <div class="col-xs-offset-4 col-xs-4">
                    <button type="submit" class="btn btn-default btn-block">登录</button>
                </div>

            </div>
        </form>
    </div>
    <!-- /.login-box-body -->
</div>
<!-- /.login-box -->
<div th:replace="common/script"></div>
<script>
    $(function () {

        $("#loginForm").submit(function (e) {
            e.preventDefault();
            var username = $("#username").val() || "";
            username = username.trim();
            if (!username) {
                toastr.error("用户名不能为空");
                return;
            }
            var password = $("#password").val() || "";
            password = password.trim();
            if (!password) {
                toastr.error("密码不能为空");
                return;
            }
            $.ajax({
                url: ctxPath + "/api/common/user/login",
                type: "post",
                data: $.param({username: username, password: password}),
                beforeSend: function () {
                    NProgress.start();
                },
                complete: function () {
                    NProgress.done();
                },
                success: function (data, textStatus, jqXHR) {
                    $(location).prop("href", ctxPath + "/");
                },
                error: function (jqXhr, textStatus, errorThrown) {
                    console.error(textStatus);
                    var status = jqXhr.status;
                    var msg = "服务异常，请稍后再试";
                    if (status === 401) {
                        msg = "用户名或密码错误";
                    }
                    toastr.error(msg);
                }
            });
        });

    });
</script>
</body>
</html>